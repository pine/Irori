#!/usr/bin/env node
'use strict'

const koa = require('koa')
const logger = require('koa-logger')
const mongo = require('koa-mongo')
const bodyParser = require('koa-bodyparser')

const pkg = require('../package.json')
const router = require('../lib/router')

const app = koa()

app.name = pkg.name.toLowerCase()

app.use(logger())
app.use(mongo({
  host: 'localhost',
  port: 27017,
  db: app.name
}))

app.use(bodyParser())
app.use(router.routes())
app.use(router.allowedMethods())

const port = process.env.PORT || 8080
app.listen(port)
console.log('Koa server start listening on port ' + port)

// vim: se et ts=2 sw=2 sts=2 ft=javascript :
